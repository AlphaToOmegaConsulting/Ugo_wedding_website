---
interface Props {
  currentPath?: string;
  class?: string;
  mobile?: boolean;
}

const { currentPath = '', class: className = '', mobile = false } = Astro.props;

// Get base path from Astro config
const base = import.meta.env.BASE_URL;

// Helper to build URLs with proper slash handling
function buildUrl(page: string): string {
  const normalizedBase = base.endsWith('/') ? base.slice(0, -1) : base;
  return page ? `${normalizedBase}/${page}` : normalizedBase;
}

// Navigation links for wedding site
const links = [
  { href: buildUrl(''), label: 'Accueil' },
  { href: buildUrl('programme.html'), label: 'Programme' },
  { href: buildUrl('infos.html'), label: 'Infos pratiques' },
  { href: buildUrl('hebergements.html'), label: 'HÃ©bergements' },
  { href: buildUrl('galerie.html'), label: 'Galerie' },
  { href: buildUrl('rsvp.html'), label: 'RSVP' },
];

// Check if a link is active
const isActive = (href: string) => {
  // Exact match for home page
  if (href === '/' && currentPath === '/') return true;
  // Prefix match for other pages
  if (href !== '/' && currentPath.startsWith(href)) return true;
  return false;
};

// Different styles for desktop vs mobile
const getLinkClass = (href: string) => {
  if (mobile) {
    return `text-base font-medium px-3 py-2 rounded-md transition-colors focus-ring ${
      isActive(href)
        ? 'text-brand-primary bg-blue-50'
        : 'text-gray-700 hover:text-brand-primary hover:bg-gray-50'
    }`;
  }
  return `text-sm font-medium transition-colors focus-ring rounded px-2 py-1 ${
    isActive(href)
      ? 'text-brand-primary border-b-2 border-brand-primary'
      : 'text-gray-700 hover:text-brand-primary'
  }`;
};
---

<nav class={className} aria-label="Navigation principale">
  {links.map((link) => (
    <a
      href={link.href}
      class={getLinkClass(link.href)}
      aria-current={isActive(link.href) ? 'page' : undefined}
    >
      {link.label}
    </a>
  ))}
</nav>
